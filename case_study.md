# Оптимизация размера JS bundle

## Актуальная проблема

В текущем проекте, как показывает инструмент `coverage` в `Chrome DevTools`, слишком велик размер JS
файлов. Было решено сократить размер доставляемого bundle'a и, таким образом, сократить время
загруки сайта.

## Формирование метрики

В качестве метрики был выбран размер JS bundle. В качестве бюджета был задан размер в 460_000 КБ.
Анализ размера бандла оценивается с помощью инструмента `sitespeed.io` при подключении файла
`homeBudjet.json`, в котором задан максимальный размер файла.

## Гарантия работы оптимизированной программы

Для гарантии работы оптимизированной программы были использованы уже существующие в приложении
тесты, написанные с помощью библиотеки `rspec`.

## Feedback-Loop

Для эффективной оптимизации был выстроен следующий `feedback-loop`: Профилирование с использованием
`sitespeed.io` и `webpack-bundle-analyzer` -> Оптимизация ->
Проверка работы программы с использованием тестов.

## Анализ точек роста

### Анализ размера используемых библиотек

Для анализа размера используемых библиотек была использована библиотека `webpack-bundle-analyzer`.
С ее помощью было выяснено, что наибольший объем паямти (более 500 КБ) занимает `moment.js`. В
проекте данная библиотека используется в `proCharts.js`, которая загружается в дашборде пользователя
с PRO-статусом. При комментировании кода в `proCharts.js` `moment.js` более не используется в
проекте, что позволило нам уложиться в бюджет оптимизации.

### Закрепление результатов оптимизации

Так как в процессе разработки возможен случай подключения огромной библиотеки в проект, было решено
включить в CI pipeline проверку на размер JS бандла. В качестве CI системы была выбрана
`GitHub Actions`.

### Результаты

В результате проведенной оптимизации размер бандла сократился более чем в два раза. Проверка на
размер JS бандла была включена в CI pipeline.
